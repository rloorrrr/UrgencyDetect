# ğŸš¨ Urgency â€“ ê¸´ê¸‰ë„ íŒë³„ AI

ë³¸ í”„ë¡œì íŠ¸ëŠ” ë©‹ìŸì´ì‚¬ìì²˜ëŸ¼ AI ìì—°ì–´ì²˜ë¦¬(NLP) ë‹¨ê¸° ì‹¬í™” ê³¼ì •ì—ì„œ ì§„í–‰í•œ  
ìŒì„±Â·í…ìŠ¤íŠ¸ ë©€í‹°ëª¨ë‹¬ ê¸°ë°˜ ê¸´ê¸‰ë„ íŒë‹¨ ëª¨ë¸ êµ¬ì¶• í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

## ğŸ§© ë°ì´í„° ì „ì²˜ë¦¬

1ï¸âƒ£ WAVâ€“JSON ë§¤ì¹­  
- `1. ì›ì²œ ë°ì´í„°` ë‚´ `.wav` íŒŒì¼ê³¼ `2. ë¼ë²¨ë§ ë°ì´í„°` ë‚´ `.json` íŒŒì¼ì„ íŒŒì¼ëª… ê¸°ì¤€ìœ¼ë¡œ ë§¤ì¹­  
- JSONì˜ `utterances.text`ë¥¼ ì¶”ì¶œí•˜ê³ , `[ê°œì¸ì •ë³´]` ë¬¸êµ¬ ì œê±°  
- `id_key`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©í•˜ì—¬ ì˜¤ë””ì˜¤â€“ë¼ë²¨ë§ ë§¤ì¹­ ì™„ë£Œ

2ï¸âƒ£ í…ìŠ¤íŠ¸ ì „ì²˜ë¦¬  
- ì—¬ëŸ¬ ë°œí™”ë¥¼ í•˜ë‚˜ë¡œ ì—°ê²°í•˜ì—¬ `all_text` ì»¬ëŸ¼ ìƒì„±  
- ê³µë°± ë° íŠ¹ìˆ˜ë¬¸ì ì œê±°  
- ê¸´ê¸‰ë„(`urgencyLevel`)ë¥¼ ì •ìˆ˜ ë¼ë²¨ë¡œ ë§¤í•‘: {'í•˜': 0, 'ì¤‘': 1, 'ìƒ': 2}

3ï¸âƒ£ ë°ì´í„° ë¶ˆê· í˜• ì™„í™”  
- í´ë˜ìŠ¤ ë¶ˆê· í˜• í•´ì†Œë¥¼ ìœ„í•´ WeightedRandomSampler ì‚¬ìš©  
- í•™ìŠµ ì‹œ ê° í´ë˜ìŠ¤ì— ì—­ë¹„ë¡€ ê°€ì¤‘ì¹˜ë¥¼ ì ìš©

4ï¸âƒ£ ìµœì¢… ë°ì´í„°ì…‹ ì»¬ëŸ¼  
| ì»¬ëŸ¼ëª… | ì„¤ëª… |
|----------------|-------------------------------------|
| `audio_path`   | WAV íŒŒì¼ ê²½ë¡œ                        |
| `all_text`     | ì „ì²˜ë¦¬ëœ í†µí•© í…ìŠ¤íŠ¸                  |
| `urgencyLevel` | ì›ë³¸ ê¸´ê¸‰ë„ ë¼ë²¨                      |
| `label`        | ì •ìˆ˜í˜• ê¸´ê¸‰ë„ ë¼ë²¨ (0:í•˜, 1:ì¤‘, 2:ìƒ) |

- ìµœì¢… ë°ì´í„° CSV: `./preprocess_data/preprocess.csv`

## ğŸ§  í•™ìŠµ ë°©ì‹

```mermaid
flowchart TD
    A[AI-Hub ìŒì„± + JSON ë°ì´í„°] --> B[ì „ì²˜ë¦¬]
    B --> C[Dataset êµ¬ì„±]
    C --> D[ë©€í‹°ëª¨ë‹¬ ëª¨ë¸: Whisper + KoELECTRA]
    D --> E[Cross-Attention ê¸°ë°˜ ì„ë² ë”© ìœµí•©]
    E --> F[Classifier: ê¸´ê¸‰ë„(í•˜Â·ì¤‘Â·ìƒ) ì˜ˆì¸¡]
    F --> G[ì„±ëŠ¥ í‰ê°€ ë° ì¶”ë¡  ì‹œìŠ¤í…œ êµ¬ì¶•]
```

- ì˜¤ë””ì˜¤ ì¸ì½”ë”: Whisper Encoder (`openai/whisper-small`)  
- í…ìŠ¤íŠ¸ ì¸ì½”ë”: KoELECTRA (`monologg/koelectra-base-v3-discriminator`)  
- ê²°í•© êµ¬ì¡°: Cross-Attention(2ì¸µ, head=8) + Hybrid Pooling(CLS+Mean)  
- ì •ê·œí™”: GroupNorm + LayerNorm ìœµí•©  
- ì†ì‹¤í•¨ìˆ˜: FocalLoss(Î³=1.8) + Weighted Sampler  
- ìŠ¤ì¼€ì¤„ëŸ¬: CosineAnnealingWarmRestarts  
- EarlyStopping: Validation F1 Score ê¸°ì¤€

## âš™ï¸ ëª¨ë¸ êµ¬ì¡° ìš”ì•½

```
ìŒì„±(WAV)  â†’ Whisper Encoder â†’ AudioSeqEncoder
í…ìŠ¤íŠ¸(JSON) â†’ KoELECTRA Encoder â†’ TextSeqEncoder
â†“
Cross-Attention Fusion
â†“
Classifier (Linear + ReLU + Dropout)
â†“
ê¸´ê¸‰ë„ ì¶œë ¥ (í•˜ / ì¤‘ / ìƒ)
```

- ëª¨ë¸ í•™ìŠµ ì½”ë“œ: `embedding+train.py`  
- ì¶”ë¡  ì½”ë“œ: `inference.py` (JSON + WAV ì…ë ¥ ì§€ì›)

## ğŸ” ì¶”ë¡  (Inference)

```bash
python inference.py
```

**ì˜ˆì‹œ ì¶œë ¥:**
```
ğŸ—£ï¸ JSON í…ìŠ¤íŠ¸ ì˜ˆì‹œ: 119ì…ë‹ˆë‹¤. ë„¤. ë„¤, ì € ë­ì§€? ì—„ë§ˆê°€ í—ˆë¦¬ë¥¼ ì§€ê¸ˆ ë‹¤ì¹˜ì…”ê°€ì§€ê³ . ì „í˜€ ì›€ì§ì´ì§€ë¥¼ ëª»í•˜ì…”ì„œ ë³‘ì›ì„ ê°€ë´ì•¼ ë  ê²ƒ ê°™ì€ë° ì™€ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”? ì–´. ë­ í—ˆë¦¬ë¥¼ ë‹¤ì¹˜ì…¨ì–´ìš”, ì–´ë–»ê²Œ ...
ğŸ§ ì˜¤ë””ì˜¤ íŒŒì¼: 6509537abc5846983ad2efb3_20230523072543.wav
âœ… ì˜ˆì¸¡ëœ ê¸´ê¸‰ë„: í•˜
ğŸ“Š í™•ë¥ ë¶„í¬: [0.37645307 0.34889665 0.27465025]
```

ëª¨ë¸ ê°€ì¤‘ì¹˜(`.pt`) íŒŒì¼ì€ `/content/drive/MyDrive/test_data/model/1500_model.pt` ìœ„ì¹˜ì— ì €ì¥ë©ë‹ˆë‹¤.

## ğŸ“Š ëª¨ë¸ ì„±ê³¼

Test Accuracy     : 0.2767
Weighted F1 Score : 0.2776 
